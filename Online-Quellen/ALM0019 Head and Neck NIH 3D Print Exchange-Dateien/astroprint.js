'use strict';if(!window.astroprint){window.astroprint={}}(function(){if(document.isAstroPrintLoaded){return}document.isAstroPrintLoaded=true;var ORIGIN="https://widgets.astroprint.com";var backdrop=document.createElement("div");backdrop.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:black;display:none;transition:opacity 0.5s";var loader=document.createElement("img");loader.setAttribute("src","//d360wfgz11cs0l.cloudfront.net/ajax-loader-light.gif");loader.style.cssText="position:absolute;top:50%;left:50%;margin:-27px 0 0 -20px";backdrop.appendChild(loader);document.body.appendChild(backdrop);var iframe=document.createElement("iframe");iframe.setAttribute("marginheight",0);iframe.setAttribute("marginwidth",0);iframe.setAttribute("frameborder",0);iframe.setAttribute("border",0);iframe.style.cssText="z-index: 2147483647; position: fixed; overflow: hidden; top: 0px; right: 0px; bottom: 0px; left: 0px; margin: 0px; padding: 0px; width: 100%; height: 100%; border: none; opacity: 1;display:none";iframe.onload=function(){loader.style.display="none";iframe.style.display="block"};var closeIframe=function closeIframe(){if(iframe.parentNode){document.body.removeChild(iframe);backdrop.style.opacity=0;iframe.src=null;setTimeout(function(){backdrop.style.display="none"},500)}};backdrop.onclick=function(){closeIframe()};window.astroprint.importDesign=function(downloadUrl,name,token,protection){loader.style.display="block";backdrop.style.display="block";backdrop.style.opacity=0.45;iframe.src=ORIGIN+"/importbutton?dl="+encodeURIComponent(downloadUrl)+"&n="+encodeURIComponent(name)+(token?"&t="+encodeURIComponent(token):"")+(protection?"&p="+encodeURIComponent(protection):"");document.body.insertBefore(iframe,document.body.firstChild)};window.astroprint.importDesignByBlob=function(blob,contentType,name,protection){loader.style.display="block";backdrop.style.display="block";backdrop.style.opacity=0.45;iframe.src=ORIGIN+"/importbutton?dl=blob&n="+encodeURIComponent(name)+(protection?"&p="+encodeURIComponent(protection):"");iframe.blobInfo={blob:blob,contentType:contentType};document.body.insertBefore(iframe,document.body.firstChild)};window.astroprint.setOrigin=function(origin){ORIGIN=origin};var clickCallback=function clickCallback(evt){evt.preventDefault();var e=evt.currentTarget;var downloadUrl=e.getAttribute("data-ap-download-url");var name=e.getAttribute("data-ap-name");var token=e.getAttribute("data-ap-token");var protection=e.getAttribute("data-ap-protection");window.astroprint.importDesign(downloadUrl,name,token,protection)};var buttons=document.getElementsByClassName("astroprint-import");for(var i=0;i<buttons.length;i++){buttons[i].addEventListener("click",clickCallback)}window.addEventListener("message",function(evt){if(evt.origin!=ORIGIN){return}if(evt.data){switch(evt.data.event){case"closed":closeIframe();break;case"ready-for-blob":if(iframe.blobInfo){var receiver=iframe.contentWindow;receiver.postMessage(iframe.blobInfo,ORIGIN)}else{console.warn("Invalid blobInfo on iframe")}break;default:console.warn("Unknown event received: "+evt.data.event);}}})})();